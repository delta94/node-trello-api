{"version":3,"sources":["../../src/middleware/verifyToken.js"],"names":["verifyToken","req","res","next","token","header","status","send","error","msg","invalid","jwt","verify","JWT_SECRET_KEY","decode","user"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AAEA,IAAMA;AAAA,sFAAc,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACZC,iBADY,GACJH,IAAII,MAAJ,CAAW,cAAX,CADI;;AAAA,gBAEbD,KAFa;AAAA;AAAA;AAAA;;AAAA,6CAGTF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAK,kCAFqB;AAG1BC,uBAAS;AAHiB,aAArB,CAHS;;AAAA;AAAA;AAAA;AAAA,mBAWRC,uBAAIC,MAAJ,CAAWR,KAAX,EAAkBS,sBAAlB,CAXQ;;AAAA;AAUVC,kBAVU;;;AAahBb,gBAAIc,IAAJ,GAAWD,MAAX;AACAX;AAdgB;AAAA;;AAAA;AAAA;AAAA;;AAgBhBD,gBAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,IAAT,EAAeC,KAAK,eAApB,EAAqCC,SAAS,IAA9C,EAArB;;AAhBgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAd;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAoBeV,W","file":"verifyToken.js","sourcesContent":["import jwt from \"jsonwebtoken\";\nimport { JWT_SECRET_KEY } from \"../config/config\";\n\nconst verifyToken = async (req, res, next) => {\n  const token = req.header('x-auth-token');\n  if (!token)\n    return res.status(401).send({\n      error: true,\n      msg: 'Access denied, no token provided',\n      invalid: false\n    });\n\n  try {\n    const decode =\n      await jwt.verify(token, JWT_SECRET_KEY);\n\n    req.user = decode;\n    next();\n  } catch (ex) {\n    res.status(401).send({ error: true, msg: \"Invalid Token\", invalid: true });\n  }\n}\n\nexport default verifyToken;\n"]}
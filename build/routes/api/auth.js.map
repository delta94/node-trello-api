{"version":3,"sources":["../../../src/routes/api/auth.js"],"names":["router","express","Router","post","req","res","body","email","password","error","status","send","msg","details","message","User","findOne","user","token","bcrypt","compare","isValidPassword","generateAuthToken","header"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AAEA;;;;AAEA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEAF,OAAOG,IAAP,CAAY,GAAZ;AAAA,sFAAiB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,wBACaD,IAAIE,IADjB,EACPC,KADO,aACPA,KADO,EACAC,QADA,aACAA,QADA;;AAGf;;AAHe,gCAIG,kCAAiBJ,IAAIE,IAArB,CAJH,EAIPG,KAJO,qBAIPA,KAJO;;AAAA,iBAKXA,KALW;AAAA;AAAA;AAAA;;AAAA,6CAMNJ,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BF,qBAAO,IADmB;AAE1BG,mBAAKH,MAAMI,OAAN,CAAc,CAAd,EAAiBC;AAFI,aAArB,CANM;;AAAA;AAAA;AAAA,mBAYEC,iBAAKC,OAAL,CAAa,EAAET,YAAF,EAAb,CAZF;;AAAA;AAYXU,gBAZW;;AAAA,gBAaVA,IAbU;AAAA;AAAA;AAAA;;AAAA,6CAcNZ,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BF,qBAAO,IADmB;AAE1BG,mBAAK,iBAFqB;AAG1BM,qBAAO;AAHmB,aAArB,CAdM;;AAAA;AAAA;AAAA,mBAsBPC,mBAAOC,OAAP,CAAeZ,QAAf,EAAyBS,KAAKT,QAA9B,CAtBO;;AAAA;AAqBTa,2BArBS;;AAAA,gBAwBVA,eAxBU;AAAA;AAAA;AAAA;;AAAA,6CAyBNhB,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BF,qBAAO,IADmB;AAE1BG,mBAAK,qBAFqB;AAG1BM,qBAAO;AAHmB,aAArB,CAzBM;;AAAA;AA+BTA,iBA/BS,GA+BDD,KAAKK,iBAAL,EA/BC;;AAgCfjB,gBAAIK,MAAJ,CAAW,GAAX,EAAgBa,MAAhB,CAAuB,cAAvB,EAAuCL,KAAvC,EAA8CP,IAA9C,CAAmD;AACjDF,qBAAO,KAD0C;AAEjDG,mBAAK,kBAF4C;AAGjDM,qBAAOA;AAH0C,aAAnD;;AAhCe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;;kBAwCelB,M","file":"auth.js","sourcesContent":["import express from 'express';\nimport bcrypt from \"bcryptjs\";\n\nimport { User, validateAuthUser } from \"../../models/userSchema\";\n\nconst router = express.Router();\n\nrouter.post('/', async (req, res) => {\n  const { email, password } = req.body;\n\n  // Validate input value to match schema\n  const { error } = validateAuthUser(req.body);\n  if (error)\n    return res.status(400).send({\n      error: true,\n      msg: error.details[0].message\n    });\n\n  // Find user email\n  let user = await User.findOne({ email });\n  if (!user)\n    return res.status(400).send({\n      error: true,\n      msg: 'Email Not found',\n      token: \"\"\n    });\n\n  // Password validation\n  const isValidPassword =\n    await bcrypt.compare(password, user.password);\n\n  if (!isValidPassword)\n    return res.status(400).send({\n      error: true,\n      msg: 'Password not match!',\n      token: \"\"\n    });\n\n  const token = user.generateAuthToken();\n  res.status(200).header('x-auth-token', token).send({\n    error: false,\n    msg: \"Login Successful\",\n    token: token\n  });\n});\n\n\nexport default router;\n"]}
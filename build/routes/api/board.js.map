{"version":3,"sources":["../../../src/routes/api/board.js"],"names":["router","express","Router","get","auth","req","res","Board","find","closed","idOrganization","user","_id","boards","status","send","error","msg","id","params","findById","populate","path","model","List","User","board","put","body","name","bgPath","details","message","findOneAndUpdate","new","delete","findOneAndDelete","post","save"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AAEA;;AACA;;AACA;;AACA;;AACA;;;;;;AAEA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEA;;;;;AAKAF,OAAOG,GAAP,CAAW,GAAX,EAAgBC,wBAAhB;AAAA,sFAAuB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACAC,mBAAMC,IAAN,CAAW,EAAEC,QAAQ,KAAV,EAAiBC,gBAAiBL,IAAIM,IAAJ,CAASC,GAA3C,EAAX,CADA;;AAAA;AACfC,kBADe;;AAAA,gBAEhBA,MAFgB;AAAA;AAAA;AAAA;;AAAA,6CAGZP,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAK;AAFqB,aAArB,CAHY;;AAAA;AAAA,6CAQdX,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,MAArB,CARc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;;AAWA;;;;;AAKAb,OAAOG,GAAP,CAAW,MAAX,EAAmBC,wBAAnB;AAAA,uFAA0B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBY,cADgB,GACTb,IAAIc,MADK,CAChBD,EADgB;AAAA;AAAA,mBAEJX,mBAAMa,QAAN,CAAe,EAAER,KAAKM,EAAP,EAAf,EAA4BG,QAA5B,CAAqC,CACvD;AACEC,oBAAM,OADR;AAEEC,qBAAOC;AAFT,aADuD,EAKvD;AACEF,oBAAM,gBADR;AAEEC,qBAAOE;AAFT,aALuD,CAArC,CAFI;;AAAA;AAElBC,iBAFkB;;AAAA,gBAanBA,KAbmB;AAAA;AAAA;AAAA;;AAAA,8CAcfpB,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAK;AAFqB,aAArB,CAde;;AAAA;;AAmBxBX,gBAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBW,KAArB;;AAnBwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1B;;AAAA;AAAA;AAAA;AAAA;;AAsBA;;;;;AAKA1B,OAAO2B,GAAP,CAAW,MAAX,EAAmBvB,wBAAnB;AAAA,uFAA0B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAChBY,cADgB,GACTb,IAAIc,MADK,CAChBD,EADgB;AAAA,wBAECb,IAAIuB,IAFL,EAEhBC,IAFgB,aAEhBA,IAFgB,EAEVC,MAFU,aAEVA,MAFU;AAAA,6BAIN,gCAAczB,IAAIuB,IAAlB,CAJM,EAIhBZ,KAJgB,kBAIhBA,KAJgB;;AAAA,iBAKpBA,KALoB;AAAA;AAAA;AAAA;;AAAA,8CAMfV,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAKD,MAAMe,OAAN,CAAc,CAAd,EAAiBC;AAFI,aAArB,CANe;;AAAA;AAAA;AAAA,mBAWJzB,mBAAM0B,gBAAN,CAAuB,EAACrB,KAAKM,EAAN,EAAvB,EAAkC;AACpDW,wBADoD;AAEpDC;AAFoD,aAAlC,EAGjB,EAACI,KAAK,IAAN,EAHiB,CAXI;;AAAA;AAWlBR,iBAXkB;;AAAA,gBAgBnBA,KAhBmB;AAAA;AAAA;AAAA;;AAAA,8CAiBfpB,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAK;AAFqB,aAArB,CAjBe;;AAAA;;AAsBxBX,gBAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBW,KAArB;;AAtBwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1B;;AAAA;AAAA;AAAA;AAAA;;AAyBA;;;;;AAKA1B,OAAOmC,MAAP,CAAc,UAAd,EAA0B/B,wBAA1B;AAAA,uFAAgC,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACtBY,cADsB,GACfb,IAAIuB,IADW,CACtBV,EADsB;AAAA;AAAA,mBAGZX,mBAAM6B,gBAAN,CAAuB,EAAExB,KAAKM,EAAP,EAAvB,CAHY;;AAAA;AAG1BQ,iBAH0B;;AAAA,gBAIzBA,KAJyB;AAAA;AAAA;AAAA;;AAAA,8CAKrBpB,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAK;AAFqB,aAArB,CALqB;;AAAA;;AAU9BX,gBAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,OAAO,KAAR,EAAeC,KAAK,eAApB,EAArB;;AAV8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhC;;AAAA;AAAA;AAAA;AAAA;;AAaA;;;;;AAKAjB,OAAOqC,IAAP,CAAY,SAAZ,EAAuBjC,wBAAvB;AAAA,uFAA6B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,yBACFD,IAAIuB,IADF,EACnBC,IADmB,cACnBA,IADmB,EACbC,MADa,cACbA,MADa;AAAA,8BAGT,gCAAczB,IAAIuB,IAAlB,CAHS,EAGnBZ,KAHmB,mBAGnBA,KAHmB;;AAAA,iBAKvBA,KALuB;AAAA;AAAA;AAAA;;AAAA,8CAMlBV,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,qBAAO,IADmB;AAE1BC,mBAAKD,MAAMe,OAAN,CAAc,CAAd,EAAiBC;AAFI,aAArB,CANkB;;AAAA;AAWvBN,iBAXuB,GAWf,IAAInB,kBAAJ,CAAU,EAAEsB,UAAF,EAAQnB,gBAAgBL,IAAIM,IAAJ,CAASC,GAAjC,EAAsCkB,cAAtC,EAAV,CAXe;AAAA;AAAA,mBAYrBJ,MAAMY,IAAN,EAZqB;;AAAA;AAa3BhC,gBAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBW,KAArB;;AAb2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA7B;;AAAA;AAAA;AAAA;AAAA;;kBAgBe1B,M","file":"board.js","sourcesContent":["import express from 'express';\n\nimport { Board, validateBoard } from \"../../models/boardSchema\";\nimport { List } from '../../models/listSchema';\nimport { Card } from '../../models/cardSchema';\nimport { User } from '../../models/userSchema';\nimport auth from '../../middleware/authMiddleware';\n\nconst router = express.Router();\n\n/**\n* @routes GET /api/board\n* @desc Board routes to get all borads\n* @api private\n*/\nrouter.get(\"/\", auth,  async (req, res) => {\n  const boards = await Board.find({ closed: false, idOrganization:  req.user._id });\n  if (!boards)\n    return res.status(400).send({\n      error: true,\n      msg: 'You haven\\'t created any board yet.'\n    });\n\n  return res.status(200).send(boards)\n});\n\n/**\n* @routes GET /api/board/:id\n* @desc Board routes to get specific board\n* @api private\n*/\nrouter.get(\"/:id\", auth,  async (req, res) => {\n  const { id } = req.params;\n  const board = await Board.findById({ _id: id }).populate([\n    {\n      path: \"lists\",\n      model: List\n    },\n    {\n      path: \"idOrganization\",\n      model: User\n    }\n  ]);\n\n  if (!board)\n    return res.status(400).send({\n      error: true,\n      msg: 'No board found.'\n    });\n\n  res.status(200).send(board);\n});\n\n/**\n* @routes PUT /api/board/:id\n* @desc Board routes to get specific board\n* @api private\n*/\nrouter.put(\"/:id\", auth,  async (req, res) => {\n  const { id } = req.params;\n  const { name, bgPath } = req.body;\n\n  const { error } = validateBoard(req.body);\n  if (error)\n    return res.status(400).send({\n      error: true,\n      msg: error.details[0].message\n    });\n\n  const board = await Board.findOneAndUpdate({_id: id}, {\n    name,\n    bgPath\n  }, {new: true});\n\n  if (!board)\n    return res.status(400).send({\n      error: true,\n      msg: 'No board found.'\n    });\n\n  res.status(200).send(board);\n});\n\n/**\n* @routes GET /api/board/delete\n* @desc Board routes to get all borads\n* @api private\n*/\nrouter.delete(\"/delete/\", auth, async (req, res) => {\n  const { id } = req.body;\n\n  let board = await Board.findOneAndDelete({ _id: id });\n  if (!board)\n    return res.status(400).send({\n      error: true,\n      msg: 'There is no board to delete'\n    });\n\n  res.status(200).send({error: false, msg: 'Board deleted'});\n});\n\n/**\n* @routes GET /api/\n* @desc Board routes to get all borads\n* @api private\n*/\nrouter.post(\"/create\", auth, async (req, res) => {\n  const { name, bgPath } = req.body;\n\n  const { error } = validateBoard(req.body);\n\n  if (error)\n    return res.status(400).send({\n      error: true,\n      msg: error.details[0].message\n    })\n\n  let board = new Board({ name, idOrganization: req.user._id, bgPath });\n  await board.save();\n  res.status(200).send(board);\n});\n\nexport default router;\n"]}